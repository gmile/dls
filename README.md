# Digital Life Saver (DLS)

### Registering a bot & playing with it locally

1. Obtain token from @BotFather, and set it in ENV:

    ```fish
    set TG_BOT_TOKEN=tg_bot_token_from_botfather
    ```

2. Run the server:

    ```fish
    env TG_BOT_TOKEN=... DOWNLOAD_PATH="/Users/eugene/downloads" DOWNLOAD_NAME_TEMPLATE="%(extractor)s-%(title)s-%(id)s.%(ext)s" elixir main.exs
    ```

3. Run ngrok:

    ```fish
    ngrok http 4000
    ```

    Copy URL generated by ngrok. For example: https://a1b2c3d4f5g6.ngrok.io

4. Register the server with bot, e.g. register a webhook:

    ```fish
    curl -X POST https://api.telegram.org/bot$TG_BOT_TOKEN/setWebhook?url=https://a1b2c3d4f5g6.ngrok.io/my_endpoint
    ```

5. Open bot in TG, send it a link from Twitter, YouTube or Instagram.

### Running in Docker

```bash
docker run \
  --mount type=bind,source=/Users/eugene/Downloads,target=/downloads \
  --env TG_BOT_TOKEN=$TG_BOT_TOKEN \
  --env DOWNLOAD_PATH=/downloads \
  --env DOWNLOAD_NAME_TEMPLATE="%(extractor)s-%(title)s-%(id)s.%(ext)s" \
  --publish 8080:4000 \
  dls
```
